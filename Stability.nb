(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68377,       1632]
NotebookOptionsPosition[     64339,       1565]
NotebookOutlinePosition[     65043,       1588]
CellTagsIndexPosition[     64954,       1583]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RowDelete", "[", 
    RowBox[{"x_", ",", "entries_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"list", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"list", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"entries", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "entries", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Delete", "[", 
       RowBox[{"x", ",", "list"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "ColumnDelete", " ", "takes", " ", "a", " ", "matrix", " ", "and", " ", 
    "delete", " ", "the", " ", "specified", " ", "columns"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColumnDelete", "[", 
    RowBox[{"x_", ",", "entries_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"RowDelete", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "x", "]"}], ",", "entries"}], "]"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "AddZeroToRow", " ", "adds", " ", "a", " ", "zero", " ", "to", " ", "a", 
    " ", "row", " ", "vector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddZeroToRow", "[", 
    RowBox[{"x_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "l", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{"x", ",", 
          RowBox[{"j", "-", "1"}]}], "]"}], ",", 
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"Take", "[", 
         RowBox[{"x", ",", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"l", "-", "j", "+", "1"}], ")"}]}]}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "AddZerosToRow", " ", "will", " ", "add", " ", "any", " ", "number", " ", 
    "of", " ", "zeros", " ", "to", " ", "a", " ", "row", " ", "vector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddZerosToRow", "[", 
    RowBox[{"x_", ",", "entries_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", "list", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "=", "x"}], ";", "\[IndentingNewLine]", 
      RowBox[{"list", "=", 
       RowBox[{"Sort", "[", "entries", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "list", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"y", "=", 
         RowBox[{"AddZeroToRow", "[", 
          RowBox[{"y", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "y"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MAR", "[", 
    RowBox[{"datasets_", ",", " ", "cov_", ",", " ", "constraints_"}], "]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "X", ",", "U", ",", "Y", ",", "Z", ",", "D", ",", "d0", ",", "p", ",", 
       "x0", ",", "u0", ",", "y0", ",", "one", ",", "popdata", ",", "covdata",
        ",", "tanks", ",", "tankrow", ",", "index", ",", "tempdata", ",", "c",
        ",", "j", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"datasets", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "-", "cov"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"cov", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"X", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"Y", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"Length", "[", "datasets", "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"x0", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"datasets", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"Length", "[", 
                RowBox[{"datasets", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"y0", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"datasets", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"X", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"X", ",", "x0"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Y", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"Y", ",", "y0"}], "]"}]}]}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"one", "=", 
          RowBox[{"{", 
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "X", "]"}]}], "}"}]}], "]"}], "}"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Z", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"one", ",", 
             RowBox[{"Transpose", "[", "X", "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"D", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", "p"}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"c", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "1"}], ",", 
              RowBox[{"j", "\[LessEqual]", "p"}], ",", 
              RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"c", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"c", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"constraints", ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "j"}], "}"}]}], "]"}], ",", 
                   RowBox[{"{", "j", "}"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"d0", "=", 
             RowBox[{"{", 
              RowBox[{"AddZerosToRow", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Y", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "k"}], "]"}], "]"}], "}"}], ".", 
                  RowBox[{"ColumnDelete", "[", 
                   RowBox[{"Z", ",", 
                    RowBox[{"c", "+", "1"}]}], "]"}], ".", 
                  RowBox[{"Inverse", "[", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"ColumnDelete", "[", 
                    RowBox[{"Z", ",", 
                    RowBox[{"c", "+", "1"}]}], "]"}], "]"}], ".", 
                    RowBox[{"ColumnDelete", "[", 
                    RowBox[{"Z", ",", 
                    RowBox[{"c", "+", "1"}]}], "]"}]}], "]"}]}], "]"}], ",", 
                RowBox[{"c", "+", "1"}]}], "]"}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"D", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"D", ",", "d0"}], "]"}]}]}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "D"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"X", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"Y", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"U", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"Length", "[", "datasets", "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tempdata", "=", 
             RowBox[{"datasets", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"x0", "=", 
             RowBox[{"tempdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{
                 RowBox[{"cov", "+", "1"}], ";;", 
                 RowBox[{"cov", "+", "p"}]}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"x0", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"x0", ",", 
               RowBox[{"Length", "[", "x0", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"u0", "=", 
             RowBox[{"tempdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"1", ";;", "cov"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"u0", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"u0", ",", 
               RowBox[{"Length", "[", "u0", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"y0", "=", 
             RowBox[{"tempdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{
                 RowBox[{"cov", "+", "1"}], ";;", 
                 RowBox[{"cov", "+", "p"}]}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"y0", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"y0", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"X", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"X", ",", "x0"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"U", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"U", ",", "u0"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Y", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"Y", ",", "y0"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"one", "=", 
          RowBox[{"{", 
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "X", "]"}]}], "}"}]}], "]"}], "}"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Z", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"one", ",", 
             RowBox[{"Transpose", "[", "U", "]"}], ",", 
             RowBox[{"Transpose", "[", "X", "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"D", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", "p"}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"c", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "1"}], ",", 
              RowBox[{"j", "\[LessEqual]", "p"}], ",", 
              RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"c", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"c", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"constraints", ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "j"}], "}"}]}], "]"}], ",", 
                   RowBox[{"{", "j", "}"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"d0", "=", 
             RowBox[{"{", 
              RowBox[{"AddZerosToRow", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Y", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "k"}], "]"}], "]"}], "}"}], ".", 
                  RowBox[{"ColumnDelete", "[", 
                   RowBox[{"Z", ",", 
                    RowBox[{"c", "+", "1", "+", "cov"}]}], "]"}], ".", 
                  RowBox[{"Inverse", "[", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"ColumnDelete", "[", 
                    RowBox[{"Z", ",", 
                    RowBox[{"c", "+", "1", "+", "cov"}]}], "]"}], "]"}], ".", 
                    RowBox[{"ColumnDelete", "[", 
                    RowBox[{"Z", ",", 
                    RowBox[{"c", "+", "1", "+", "cov"}]}], "]"}]}], "]"}]}], 
                 "]"}], ",", 
                RowBox[{"c", "+", "1", "+", "cov"}]}], "]"}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"D", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"D", ",", "d0"}], "]"}]}]}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "D"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcessData", "[", 
    RowBox[{"raw_", ",", "cov_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rawdata", ",", "p", ",", "tankrow", ",", "tanks", ",", "purepopdata", 
       ",", "logpopdata", ",", "covdata", ",", "processeddata", ",", "index", 
       ",", "compdataset", ",", "i", ",", "i0", ",", "j", ",", "data"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rawdata", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"raw", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"rawdata", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "cov", "-", "1"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tankrow", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{
         RowBox[{"raw", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "extracts", " ", "the", " ", "column", " ", "of", " ", "tank", " ", 
        "labels", " ", "as", " ", "a", " ", "row", " ", 
        RowBox[{"vector", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tanks", "=", 
       RowBox[{"DeleteDuplicates", "[", "tankrow", "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "Just", " ", "getting", " ", "a", " ", "list", " ", "of", " ", "tank", 
        " ", "labels"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"purepopdata", "=", 
       RowBox[{"ColumnDelete", "[", 
        RowBox[{"rawdata", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "cov"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"purepopdata", "=", 
         RowBox[{"ColumnDelete", "[", 
          RowBox[{"purepopdata", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"logpopdata", "=", 
       RowBox[{"Log", "[", "purepopdata", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"cov", "\[Equal]", "0"}], ",", 
        RowBox[{"covdata", "=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"covdata", "=", 
          RowBox[{"ColumnDelete", "[", 
           RowBox[{"rawdata", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", "p"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"covdata", "=", 
            RowBox[{"ColumnDelete", "[", 
             RowBox[{"covdata", ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", 
                RowBox[{"covdata", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"processeddata", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cov", "\[Equal]", "0"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "tankrow", "}"}], ",", 
            RowBox[{"Transpose", "[", "logpopdata", "]"}]}], "]"}], "]"}], 
         ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "tankrow", "}"}], ",", 
            RowBox[{"Transpose", "[", "covdata", "]"}], ",", 
            RowBox[{"Transpose", "[", "logpopdata", "]"}]}], "]"}], "]"}]}], 
        "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "Join", " ", "log", " ", "transformed", " ", "values", " ", "back", 
        " ", "up", " ", "with", " ", "tank", " ", "labels"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Below", " ", "we", " ", "extract", " ", "tank", " ", "specific", " ", 
        "processed", " ", "data", " ", "and", " ", "label", " ", "it", " ", 
        "by", " ", "the", " ", "tank", " ", 
        RowBox[{"label", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "tanks", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"index", "=", 
          RowBox[{"tanks", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"data", "[", "index", "]"}], "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "processeddata", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"i0", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"processeddata", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                "index"}], ",", 
               RowBox[{"{", 
                RowBox[{"processeddata", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"data", "[", "index", "]"}], "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"data", "[", "index", "]"}], ",", "i0"}], "]"}]}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"data", "[", "index", "]"}], "=", 
          RowBox[{"ColumnDelete", "[", 
           RowBox[{
            RowBox[{"data", "[", "index", "]"}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"compdataset", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "tanks", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"index", "=", 
          RowBox[{"tanks", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"compdataset", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"compdataset", ",", 
            RowBox[{"{", 
             RowBox[{"data", "[", "index", "]"}], "}"}]}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "compdataset"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7383265139261045`*^9, 3.738326605620885*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ab9ac301-822a-4eff-88b7-9a1da1d6d002"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/4/Documents/Weak interactions/tank data\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "1", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<CER0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "2", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<CER_DAP0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "3", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<CER_SCA0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "4", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<DAP0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "5", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<DAPSCA0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "6", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<SCA0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "7", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "8", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_CER0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "9", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_CER_DAP0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "10", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_CER_SCA0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "11", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_DAP0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "12", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_SCA0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "13", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_SCA_DAP0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "14", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_I_DAP0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "15", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_I0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "16", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_I_COP0.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rawdata", "[", "17", "]"}], "=", 
    RowBox[{"Import", "[", "\"\<CER_SCA_DAP0.csv\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"1", " ", "covariate"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "18", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<CER.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "19", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<CER_DAP.csv\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "20", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<CER_SCA.csv\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "21", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<DAP.csv\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "22", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<DAPSCA.csv\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "23", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<SCA.csv\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "24", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "25", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_CER.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "26", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_CER_DAP.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "27", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_CER_SCA.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "28", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_Dap.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "29", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_Sca.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "30", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_SCA_DAP.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rawdata", "[", "31", "]"}], "=", 
    RowBox[{"Import", "[", "\"\<N_I_DAP.csv\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"2", " ", "covariates"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawdata", "[", "32", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<N_I.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rawdata", "[", "33", "]"}], "=", 
    RowBox[{"Import", "[", "\"\<N_I_cop.csv\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "17"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"prodata", "[", "i", "]"}], "=", 
     RowBox[{"ProcessData", "[", 
      RowBox[{
       RowBox[{"rawdata", "[", "i", "]"}], ",", "0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"m", "[", "i", "]"}], "=", 
     RowBox[{"MAR", "[", 
      RowBox[{
       RowBox[{"prodata", "[", "i", "]"}], ",", "0", ",", 
       RowBox[{"{", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "18"}], ",", 
    RowBox[{"i", "\[LessEqual]", "33"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"prodata", "[", "i", "]"}], " ", "=", " ", 
      RowBox[{"ProcessData", "[", 
       RowBox[{
        RowBox[{"rawdata", "[", "i", "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m", "[", "i", "]"}], "=", 
      RowBox[{"MAR", "[", 
       RowBox[{
        RowBox[{"prodata", "[", "i", "]"}], ",", "1", ",", 
        RowBox[{"{", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MM", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "17"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tanks", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"prodata", "[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"MM", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"MM", ",", 
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"MAR", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"prodata", "[", "i", "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "}"}], ",", "0", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "tanks"}], "}"}]}], "]"}], "}"}]}], 
      "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.7383296432888484`*^9, 3.738329700980362*^9}, {
  3.7383332403336067`*^9, 3.7383332502238255`*^9}, {3.738334317170274*^9, 
  3.738334430394497*^9}, {3.738334892452403*^9, 3.7383349173920527`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"f6733b02-5deb-4034-960b-d3d6e11dce3d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.7384964030653906`*^9},
 NumberMarks->False,
 CellLabel->"In[46]:=",ExpressionUUID->"65e938b5-6f82-467b-a758-52add5c89e0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", "[", "D_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "cov", ",", "B"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{"extract", " ", "B", " ", "matrix"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "=", 
      RowBox[{"Length", "[", "D", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cov", "=", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"D", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "p", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B", "=", 
      RowBox[{"D", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"2", "+", "cov"}], ";;", 
          RowBox[{"1", "+", "cov", "+", "p"}]}]}], "]"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7383297804649153`*^9, 3.738329810997575*^9}, {
   3.738330457793275*^9, 3.738330491775941*^9}, {3.738330553952262*^9, 
   3.738330554078062*^9}, {3.738331000846941*^9, 3.738331063646263*^9}, 
   3.738331116450968*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"1befad15-650b-4749-895d-848e75a629e4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.738331121584778*^9, 3.738331130213395*^9}, {
   3.7383313146925554`*^9, 3.7383313486294217`*^9}, {3.7383314337465897`*^9, 
   3.7383314704078608`*^9}, {3.7383316408583937`*^9, 3.738331652572217*^9}, {
   3.7383318054735174`*^9, 3.7383318995601015`*^9}, {3.738332877401218*^9, 
   3.73833287837042*^9}, {3.7383329304075203`*^9, 3.7383329320701237`*^9}, {
   3.738332976065611*^9, 3.7383330329471216`*^9}, {3.7383330930804377`*^9, 
   3.7383330932052383`*^9}, {3.7383336888690443`*^9, 3.738333708841084*^9}, {
   3.738333794444853*^9, 3.738333900003458*^9}, {3.738334261467766*^9, 
   3.7383342777221975`*^9}, {3.738334452238139*^9, 3.7383344663209677`*^9}, {
   3.738335109079629*^9, 3.738335123683858*^9}, {3.7383354167093296`*^9, 
   3.7383354242117443`*^9}, {3.7383355457659855`*^9, 
   3.7383355826304584`*^9}, {3.7383358451181707`*^9, 
   3.7383358590929976`*^9}, {3.7383359033692894`*^9, 
   3.7383359113503046`*^9}, {3.7384115561923084`*^9, 3.738411626758751*^9}, {
   3.738416344996605*^9, 3.738416370497055*^9}, {3.7384176455653515`*^9, 
   3.738417658304776*^9}, {3.738420562403945*^9, 3.738420574274769*^9}, 
   3.738504493491028*^9},
 CellLabel->
  "In[195]:=",ExpressionUUID->"c15cd7aa-739f-4770-a4a3-ddf4349aefa3"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "33"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"m", "[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"cov", "=", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"m", "[", "i", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "p", "-", "1"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Amatrix", "[", "i", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"m", "[", "i", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"1", ";;", "1"}]}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Bmatrix", "[", "i", "]"}], " ", "=", " ", 
     RowBox[{"B", "[", 
      RowBox[{"m", "[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"cov", " ", "\[Equal]", " ", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Cmatrix", "[", "i", "]"}], " ", "=", " ", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Cmatrix", "[", "i", "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"m", "[", "i", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"2", ";;", 
           RowBox[{"2", "+", "cov", "-", "1"}]}]}], "]"}], "]"}]}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.738334576842183*^9, 3.7383346343332977`*^9}, {
  3.7383349500767183`*^9, 3.7383352510989075`*^9}, {3.738335313689331*^9, 
  3.738335392474883*^9}, {3.738335622246937*^9, 3.7383356261569443`*^9}, {
  3.7383357446617746`*^9, 3.738335745742177*^9}, {3.7383380558507586`*^9, 
  3.738338122366889*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"8a559d25-b046-48b4-a7b3-7b6fa729fc06"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.738335634578761*^9, 3.7383356725810356`*^9}, {
   3.7383357079159036`*^9, 3.738335708322504*^9}, {3.7383357682812204`*^9, 
   3.738335768672221*^9}, 3.73850449988284*^9},
 CellLabel->
  "In[196]:=",ExpressionUUID->"8e158557-56b8-4828-bedd-a60655c115fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxt", " ", "=", " ", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "[", "0", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"t", "=", "1"}], ",", 
   RowBox[{"t", "\[LessEqual]", "maxt"}], ",", 
   RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"X", "[", "t", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Amatrix", "[", "1", "]"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"Bmatrix", "[", "1", "]"}], ".", 
       RowBox[{"X", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"X", "[", "1", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQfXBpnq3/rdeOQZ47HUH0qfKaGBBdN5crGUS3pKtk
gejbQuLZIDpBp6EAREf3GUwB0QLnF+8H0QViRQdA9B3RwqMgekbw8eMg+k2G
420Q/eD8lUcg+oxIaU0AkP6XXtUJol8tu7QFRO/x898For/sdzsKohU4XoPp
AGmDSyB6zYMf10H0BufcuyDafr7zIxAd9zWTMxBIO/XV8YJoNpsMQRC98c88
IRAd9lVLEkQbJOpIgeidgcJyIDpZ/JM8iDYJSFQF0RMrzjiDaJ1bBt4guvlA
sA+Inv75RCCIdj8xLwhEc7hrepYB6SIJdi8QnfW/JacCSGdY/APTlcYOxSA6
onEWmG5NfrgARF+89wZMAwCfeMat
  "],
 CellLabel->"In[49]:=",ExpressionUUID->"5b83a2e9-e419-4865-be60-a706805c39a5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1.762557703314782`", "}"}], ",", 
   RowBox[{"{", "1.3936382110423806`", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"-", "0.32339120218128004`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7384200724767866`*^9, 3.738420126942293*^9, 
  3.738420488434801*^9, 3.7384205976988153`*^9, 3.7384238091335735`*^9, 
  3.738496456988297*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"e0eecd8f-3f34-4d11-b4af-1e072333001a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.738504503188447*^9},
 NumberMarks->False,
 CellLabel->
  "In[197]:=",ExpressionUUID->"c851d8cf-ef3e-4afb-b873-adfeb64c1e4f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nstr", " ", "=", " ", "0.000001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "17"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Xlist", "[", "i", "]"}], " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"prodata", "[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"prep2", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", "0", "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"prodata", "[", "i", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"maxt", " ", "=", " ", "1000"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "\[LessEqual]", "maxt"}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"X", "[", "k", "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"Amatrix", "[", "i", "]"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"Bmatrix", "[", "i", "]"}], ".", 
             RowBox[{"X", "[", 
              RowBox[{"k", "-", "1"}], "]"}]}], "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "nstr"}], ",", "nstr"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"X", "[", 
                  RowBox[{"k", "-", "1"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}]}]}], ";", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "this", " ", "is", " ", "using", " ", "the", " ", "identity", " ",
              "matrix", " ", "as", " ", "the", " ", "covariance", " ", 
             "matrix", " ", "Sigma"}], ";", " ", 
            RowBox[{"try", " ", "something", " ", "else"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"prep1", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"l", "=", "1"}], ",", 
            RowBox[{"l", "\[LessEqual]", 
             RowBox[{"Length", "[", 
              RowBox[{"X", "[", "k", "]"}], "]"}]}], ",", 
            RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"prep1", " ", "=", " ", 
              RowBox[{"Join", "[", 
               RowBox[{"prep1", ",", 
                RowBox[{
                 RowBox[{"X", "[", "k", "]"}], "[", 
                 RowBox[{"[", "l", "]"}], "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"prep2", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"prep2", ",", 
             RowBox[{"{", "prep1", "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Xlist", "[", "i", "]"}], " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Xlist", "[", "i", "]"}], ",", 
          RowBox[{"{", "prep2", "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.738336446009433*^9, 3.7383364878835144`*^9}, {
   3.7383365284895926`*^9, 3.738336581374897*^9}, {3.738336739297576*^9, 
   3.738336740472578*^9}, {3.738336833467561*^9, 3.738336834986764*^9}, {
   3.7383371003238797`*^9, 3.738337102982885*^9}, {3.73833824530273*^9, 
   3.7383382475717344`*^9}, {3.7383384684295692`*^9, 3.7383384708223743`*^9}, 
   3.7383387058574347`*^9, {3.73833880080162*^9, 3.738338810598239*^9}, {
   3.738340004417178*^9, 3.7383400569340825`*^9}, {3.738340116796599*^9, 
   3.738340130459426*^9}, {3.7383402113219843`*^9, 3.738340296217351*^9}, {
   3.7383403853241253`*^9, 3.738340480392313*^9}, {3.7384114508184023`*^9, 
   3.7384114947324886`*^9}, {3.7384116412669787`*^9, 3.738411678999652*^9}, {
   3.7384157202551823`*^9, 3.738415829856996*^9}, {3.7384159435920196`*^9, 
   3.7384159905169106`*^9}, {3.7384161396894035`*^9, 
   3.7384161757176733`*^9}, {3.7384162359015913`*^9, 
   3.7384162473890142`*^9}, {3.738416306095128*^9, 3.738416333381383*^9}, {
   3.738416431769376*^9, 3.738416451003214*^9}, {3.7384164948663015`*^9, 
   3.7384164950087013`*^9}, {3.7384165459084015`*^9, 
   3.7384165879186845`*^9}, {3.738416940666974*^9, 3.7384169843122597`*^9}, {
   3.7384170291261473`*^9, 3.7384170451701784`*^9}, {3.7384176232603083`*^9, 
   3.7384176356565323`*^9}, {3.7384176941668463`*^9, 
   3.7384176949664483`*^9}, {3.738417742529341*^9, 3.738417749968356*^9}, {
   3.7384196267527285`*^9, 3.738419677223028*^9}, {3.7384197094142904`*^9, 
   3.7384197102586923`*^9}, {3.738419749020769*^9, 3.738419844898356*^9}, {
   3.7384198764871197`*^9, 3.7384199402156453`*^9}, {3.7384199833311296`*^9, 
   3.7384199879149384`*^9}, {3.7384200370213165`*^9, 3.73842004400393*^9}, {
   3.738420096555233*^9, 3.7384202215170774`*^9}, 3.738420311743054*^9, {
   3.738420507451838*^9, 3.7384205478585167`*^9}, {3.738420631745882*^9, 
   3.738420634281087*^9}, {3.7384237704770985`*^9, 3.738423771685301*^9}, {
   3.7384238394312325`*^9, 3.738423841842637*^9}, {3.738424021250591*^9, 
   3.73842416815448*^9}, {3.738424237792416*^9, 3.738424332135601*^9}, 
   3.73842438744191*^9, 3.738424418006571*^9, {3.7384245637278576`*^9, 
   3.738424584146298*^9}, {3.7384964803153424`*^9, 3.7384965659933095`*^9}, {
   3.7384968350588365`*^9, 3.7384968364064393`*^9}, {3.738496875121914*^9, 
   3.7384968844805336`*^9}, {3.7384969810217237`*^9, 3.738496993193547*^9}, {
   3.7384970270278125`*^9, 3.738497033290825*^9}, {3.73849706624829*^9, 
   3.73849707674891*^9}, {3.7384971950499444`*^9, 3.7384972049149637`*^9}, {
   3.7384976016581454`*^9, 3.738497657315958*^9}, {3.7384976891176205`*^9, 
   3.738497720576483*^9}, {3.7384980916869774`*^9, 3.7384981001721935`*^9}, {
   3.738498156114702*^9, 3.738498157271105*^9}, {3.738498192188574*^9, 
   3.7384981935663767`*^9}, {3.738498239753066*^9, 3.7384982737179337`*^9}, {
   3.738498470843359*^9, 3.7384984899539957`*^9}, {3.738498526316867*^9, 
   3.7384985417066965`*^9}, {3.738498574768362*^9, 3.7384985762835646`*^9}, 
   3.738498632297276*^9, 3.7385046533313437`*^9, 3.738505331636278*^9, {
   3.7385053988332086`*^9, 3.7385054195918493`*^9}, {3.738505473227554*^9, 
   3.7385055496155043`*^9}, {3.738505595873396*^9, 3.738505705690813*^9}, {
   3.7385058183084364`*^9, 3.738505897728792*^9}, {3.7385060438100786`*^9, 
   3.7385060444028797`*^9}, {3.7385061011417913`*^9, 3.738506101532792*^9}, {
   3.7385061631765137`*^9, 3.738506184962157*^9}, {3.7385062273704414`*^9, 
   3.7385062319114504`*^9}, 3.738510864884967*^9, {3.738510925332121*^9, 
   3.738510993823056*^9}, {3.7385110262457194`*^9, 3.738511090104046*^9}, 
   3.738511133705532*^9, 3.738511169901203*^9, 3.738511260077449*^9, 
   3.7385115143385496`*^9, {3.7385115797163076`*^9, 3.7385115804837093`*^9}, {
   3.738511856774885*^9, 3.7385118865565443`*^9}, {3.738511922542014*^9, 
   3.738511923294816*^9}, {3.7385120701137047`*^9, 3.73851209387055*^9}, {
   3.7385121333376284`*^9, 3.7385121358584614`*^9}, {3.7385121674149246`*^9, 
   3.7385121676187253`*^9}, {3.7385122335678563`*^9, 
   3.7385122358378606`*^9}, {3.7385122909503694`*^9, 3.7385122935957747`*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"01069217-0729-4118-a1cb-16482e986c53"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.7384981093740115`*^9},
 NumberMarks->False,ExpressionUUID->"8cf9e102-414b-4a32-b78c-2c92ebf93062"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{3.7384981061670055`*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"0e7f321b-0071-4a07-a720-4d1846e63d4a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "17"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bmatrix2", "[", "i", "]"}], "=", 
    RowBox[{"B", "[", 
     RowBox[{"MAR", "[", 
      RowBox[{
       RowBox[{"Xlist", "[", "i", "]"}], ",", "0", ",", 
       RowBox[{"{", "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.73842385363846*^9, 3.738423854577462*^9}, {
  3.7384252273591537`*^9, 3.738425227878955*^9}, {3.7384966944631605`*^9, 
  3.7384967489416676`*^9}, {3.7384967843499365`*^9, 3.738496785587339*^9}, {
  3.7384971695866947`*^9, 3.7384971721531*^9}, {3.7384972179169893`*^9, 
  3.7384972189817915`*^9}, {3.7384972789355116`*^9, 3.7384973572830653`*^9}},
 NumberMarks->False,
 CellLabel->
  "In[282]:=",ExpressionUUID->"b88e8307-2d3a-4fbc-875f-0ba62aa6d03e"],

Cell[BoxData[
 TemplateBox[{
  "Inverse","luc",
   "\"Result for \\!\\(\\*RowBox[{\\\"Inverse\\\"}]\\) of badly conditioned \
matrix \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"999.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \\\"20374.91401055331`\\\
\"}], \\\",\\\", RowBox[{\\\"-\\\", \\\"18955.75750398687`\\\"}], \\\",\\\", \
\\\"33466.55884069372`\\\", \\\",\\\", \\\"14282.341242086666`\\\", \
\\\",\\\", \\\"60273.07728565624`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"20374.91401055331`\\\"}], \
\\\",\\\", \\\"450353.94089111756`\\\", \\\",\\\", \
\\\"429446.52311906876`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"749699.6302488449`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"316130.02013375825`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3462362762688517`*^6\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"18955.75750398687`\\\"}], \
\\\",\\\", \\\"429446.52311906876`\\\", \\\",\\\", \
\\\"412419.15133575664`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"717679.7802808776`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"301575.3664404806`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.2876494863438872`*^6\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"33466.55884069372`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"749699.6302488449`\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"717679.7802808776`\\\"}], \\\",\\\", \
\\\"1.2507077341015826`*^6\\\", \\\",\\\", \\\"526368.3607449015`\\\", \
\\\",\\\", \\\"2.2448517827649694`*^6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"{\\\", RowBox[{\\\"14282.341242086666`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"316130.02013375825`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"301575.3664404806`\\\"}], \\\",\\\", \\\"526368.3607449015`\\\", \
\\\",\\\", \\\"221917.17526060715`\\\", \\\",\\\", \
\\\"945155.78045622`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"60273.07728565624`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3462362762688517`*^6\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.2876494863438872`*^6\\\"}], \\\",\\\", \\\"2.2448517827649694`*^6\\\", \
\\\",\\\", \\\"945155.78045622`\\\", \\\",\\\", \
\\\"4.029613867621566`*^6\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) may contain \
significant numerical errors.\"",2,282,91,18438629728936595006,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.738512302686392*^9},
 CellLabel->
  "During evaluation of \
In[282]:=",ExpressionUUID->"751fb347-f6a3-47f3-911d-2462071ca77b"],

Cell[BoxData[
 TemplateBox[{
  "Inverse","luc",
   "\"Result for \\!\\(\\*RowBox[{\\\"Inverse\\\"}]\\) of badly conditioned \
matrix \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"999.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \\\"20374.91401055331`\\\
\"}], \\\",\\\", RowBox[{\\\"-\\\", \\\"18955.75750398687`\\\"}], \\\",\\\", \
\\\"33466.55884069372`\\\", \\\",\\\", \\\"14282.341242086666`\\\", \
\\\",\\\", \\\"60273.07728565624`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"20374.91401055331`\\\"}], \
\\\",\\\", \\\"450353.94089111756`\\\", \\\",\\\", \
\\\"429446.52311906876`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"749699.6302488449`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"316130.02013375825`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3462362762688517`*^6\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"18955.75750398687`\\\"}], \
\\\",\\\", \\\"429446.52311906876`\\\", \\\",\\\", \
\\\"412419.15133575664`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"717679.7802808776`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"301575.3664404806`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.2876494863438872`*^6\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"33466.55884069372`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"749699.6302488449`\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"717679.7802808776`\\\"}], \\\",\\\", \
\\\"1.2507077341015826`*^6\\\", \\\",\\\", \\\"526368.3607449015`\\\", \
\\\",\\\", \\\"2.2448517827649694`*^6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"{\\\", RowBox[{\\\"14282.341242086666`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"316130.02013375825`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"301575.3664404806`\\\"}], \\\",\\\", \\\"526368.3607449015`\\\", \
\\\",\\\", \\\"221917.17526060715`\\\", \\\",\\\", \
\\\"945155.78045622`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"60273.07728565624`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3462362762688517`*^6\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.2876494863438872`*^6\\\"}], \\\",\\\", \\\"2.2448517827649694`*^6\\\", \
\\\",\\\", \\\"945155.78045622`\\\", \\\",\\\", \
\\\"4.029613867621566`*^6\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) may contain \
significant numerical errors.\"",2,282,92,18438629728936595006,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7385123027487917`*^9},
 CellLabel->
  "During evaluation of \
In[282]:=",ExpressionUUID->"70501bea-3d04-485b-8c4d-de9a06520eb2"],

Cell[BoxData[
 TemplateBox[{
  "Inverse","luc",
   "\"Result for \\!\\(\\*RowBox[{\\\"Inverse\\\"}]\\) of badly conditioned \
matrix \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"999.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \\\"20374.91401055331`\\\
\"}], \\\",\\\", RowBox[{\\\"-\\\", \\\"18955.75750398687`\\\"}], \\\",\\\", \
\\\"33466.55884069372`\\\", \\\",\\\", \\\"14282.341242086666`\\\", \
\\\",\\\", \\\"60273.07728565624`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"20374.91401055331`\\\"}], \
\\\",\\\", \\\"450353.94089111756`\\\", \\\",\\\", \
\\\"429446.52311906876`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"749699.6302488449`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"316130.02013375825`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3462362762688517`*^6\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"18955.75750398687`\\\"}], \
\\\",\\\", \\\"429446.52311906876`\\\", \\\",\\\", \
\\\"412419.15133575664`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"717679.7802808776`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"301575.3664404806`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.2876494863438872`*^6\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"33466.55884069372`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"749699.6302488449`\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"717679.7802808776`\\\"}], \\\",\\\", \
\\\"1.2507077341015826`*^6\\\", \\\",\\\", \\\"526368.3607449015`\\\", \
\\\",\\\", \\\"2.2448517827649694`*^6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"{\\\", RowBox[{\\\"14282.341242086666`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"316130.02013375825`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"301575.3664404806`\\\"}], \\\",\\\", \\\"526368.3607449015`\\\", \
\\\",\\\", \\\"221917.17526060715`\\\", \\\",\\\", \
\\\"945155.78045622`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"60273.07728565624`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3462362762688517`*^6\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.2876494863438872`*^6\\\"}], \\\",\\\", \\\"2.2448517827649694`*^6\\\", \
\\\",\\\", \\\"945155.78045622`\\\", \\\",\\\", \
\\\"4.029613867621566`*^6\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) may contain \
significant numerical errors.\"",2,282,93,18438629728936595006,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7385123027955923`*^9},
 CellLabel->
  "During evaluation of \
In[282]:=",ExpressionUUID->"49a4972f-06dc-4f28-8a6b-52901d6ff3d6"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Inverse\\\", \
\\\"::\\\", \\\"luc\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,282,94,18438629728936595006,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7385123028433924`*^9},
 CellLabel->
  "During evaluation of \
In[282]:=",ExpressionUUID->"d5eea080-9c90-4ab2-ab88-4cb79bc4777e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "17"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Bnorm1", "[", "i", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"Bmatrix", "[", "i", "]"}], ",", "\"\<Frobenius\>\""}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"B2norm1", "[", "i", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"Bmatrix2", "[", "i", "]"}], ",", "\"\<Frobenius\>\""}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dif", "[", "i", "]"}], "=", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Bmatrix", "[", "i", "]"}], "-", 
          RowBox[{"Bmatrix2", "[", "i", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Bmatrix", "[", "i", "]"}], "*", "2", "*", "nstr"}], 
         ")"}]}], ",", "\"\<Frobenius\>\""}], "]"}]}]}]}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "error", " ", "relative", " ", "to", " ", "strength", " ", 
    "of", " ", "noise"}], "*)"}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"?", "dif"}]}], "Input",
 CellChangeTimes->{{3.73849741025537*^9, 3.7384974961275377`*^9}, {
  3.7384977659131713`*^9, 3.7384977694849787`*^9}, {3.738497849074397*^9, 
  3.738497883875167*^9}, {3.738498975891835*^9, 3.7384990102173786`*^9}, {
  3.7384990420024414`*^9, 3.7384991299998164`*^9}, {3.738503655438759*^9, 
  3.73850367077159*^9}, {3.7385037155894775`*^9, 3.7385037162164783`*^9}, {
  3.738503756645159*^9, 3.738503757725561*^9}, {3.7385110140260963`*^9, 
  3.7385110143868966`*^9}, {3.738511835646844*^9, 3.738511850686473*^9}, {
  3.7385121084863796`*^9, 3.7385121185929985`*^9}, {3.738512196378783*^9, 
  3.7385122058462024`*^9}, {3.7385122672243223`*^9, 3.738512267707924*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"4cb754ef-f41b-4280-b192-bdf35e7032df"],

Cell[CellGroupData[{

Cell["Global`dif", "Print", "PrintUsage",
 CellChangeTimes->{3.738512313988614*^9},
 CellTags->
  "Info2843738497913-3261842",ExpressionUUID->"6c77ff2d-815b-47fb-b122-\
e5363034a4a7"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"dif", "[", "1", "]"}], "=", "6.910220678989352`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "2", "]"}], "=", "40.910413359456484`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "3", "]"}], "=", "22.406659097422907`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "4", "]"}], "=", "4.234819469789147`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "5", "]"}], "=", "30.800195000931232`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "6", "]"}], "=", "4.342745688419655`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "7", "]"}], "=", "82.05545824835035`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "8", "]"}], "=", "56.40387371614836`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "9", "]"}], "=", "12.394010078036963`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "10", "]"}], "=", "312.3634117380973`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "11", "]"}], "=", "17.688592033947376`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "12", "]"}], "=", "3954.2522232354927`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "13", "]"}], "=", "87.36628501743043`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "14", "]"}], "=", "50.87231827192747`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "15", "]"}], "=", "42.15163870052155`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "16", "]"}], "=", "49.07156911673575`"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"dif", "[", "17", "]"}], "=", "283.6896469332354`"}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`dif],
  Editable->False]], "Print",
 CellChangeTimes->{3.738512314019814*^9},
 CellTags->
  "Info2843738497913-3261842",ExpressionUUID->"3452e273-e1e4-4a17-ae6f-\
c94a727b704b"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.738423965366279*^9, 3.7384239843903165`*^9}, {
  3.7384979852999673`*^9, 3.7384980698967347`*^9}, {3.738504390791025*^9, 
  3.7385044142906713`*^9}},
 NumberMarks->False,ExpressionUUID->"5147f79b-e5f7-4327-8237-053bf9be0966"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7385044076104584`*^9, 
  3.7385044076416583`*^9}},ExpressionUUID->"05ec5ff6-b25f-4aab-a645-\
c098653b39a4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7385044182504787`*^9, 3.7385044311891046`*^9}},
 NumberMarks->False,ExpressionUUID->"342f7630-136c-4166-95d5-c92afbab4a3b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7385044214730854`*^9, 3.7385044216290855`*^9}},
 NumberMarks->False,ExpressionUUID->"17b365ee-1a13-4856-bb18-a8d48e35b68d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7385044228030877`*^9, 
  3.738504422991288*^9}},ExpressionUUID->"26a4196f-f650-47fd-9fff-\
61839d19ce44"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.73850442410289*^9, 3.7385044242754903`*^9}},
 NumberMarks->False,
 CellLabel->
  "In[188]:=",ExpressionUUID->"7fa41b16-7fe8-415a-8e26-f01b1a0db8cb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.738504425557693*^9, 3.738504425729293*^9}},
 NumberMarks->False,
 CellLabel->
  "In[187]:=",ExpressionUUID->"2a6a1eea-958f-4430-8e1f-63ab2a2e3021"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7385044269630966`*^9, 3.7385044271200967`*^9}},
 NumberMarks->False,
 CellLabel->
  "In[186]:=",ExpressionUUID->"05808b92-e301-4f41-a097-9f1d70d82bea"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7383400191250086`*^9, 3.7383400199538097`*^9}, 
   3.7384158472908306`*^9, {3.7384159143789616`*^9, 3.738415920754174*^9}, {
   3.7384160690842657`*^9, 3.7384160725614724`*^9}, 3.738504440645523*^9},
 CellLabel->
  "In[185]:=",ExpressionUUID->"36e98c85-6935-4d69-ac84-463776cbc2fa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"totiter", " ", "=", " ", "1000000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"avg", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tot", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "totiter"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tot", " ", "=", " ", 
     RowBox[{"tot", "+", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"avg", " ", "=", " ", 
   RowBox[{"tot", " ", "/", " ", "totiter"}]}], 
  ";"}], "\[IndentingNewLine]", "avg"}], "Input",
 CellChangeTimes->{
  3.738335762720209*^9, {3.738411304245118*^9, 3.7384113069237237`*^9}, {
   3.7384113976168995`*^9, 3.7384114014967065`*^9}, {3.738415852413041*^9, 
   3.738415874596284*^9}, {3.738416008283945*^9, 3.738416031983392*^9}, {
   3.738504063507377*^9, 3.7385042385467243`*^9}, {3.7385043176468806`*^9, 
   3.7385043384287205`*^9}, {3.7385044646403694`*^9, 3.738504476265192*^9}},
 NumberMarks->False,
 CellLabel->
  "In[189]:=",ExpressionUUID->"0f7dfab6-7c6e-4d57-b949-1700251eae8a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"-", "0.00014259093638592299`"}], "}"}], ",", 
   RowBox[{"{", "0.0001471293111472849`", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"-", "0.0007195227362880726`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7384114020603075`*^9, {3.738415869369874*^9, 3.738415875675686*^9}, {
   3.7384160002677298`*^9, 3.738416032750793*^9}, 3.738504218526884*^9, {
   3.73850430294565*^9, 3.7385043439515314`*^9}, 3.7385044808872013`*^9},
 CellLabel->
  "Out[194]=",ExpressionUUID->"9c42dee5-7ed4-4b32-aba6-24e68338ad17"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7383311395822134`*^9, 
  3.738331160619654*^9}},ExpressionUUID->"d5ff732a-3d09-4bcb-849f-\
e54387c0cab0"]
},
WindowSize->{1920, 998},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info2843738497913-3261842"->{
  Cell[57381, 1358, 183, 4, 45, "Print",ExpressionUUID->"6c77ff2d-815b-47fb-b122-e5363034a4a7",
   CellTags->"Info2843738497913-3261842"],
  Cell[57567, 1364, 2651, 88, 518, "Print",ExpressionUUID->"3452e273-e1e4-4a17-ae6f-c94a727b704b",
   CellTags->"Info2843738497913-3261842"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info2843738497913-3261842", 64649, 1575}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 22274, 536, 2309, "Input",ExpressionUUID->"ab9ac301-822a-4eff-88b7-9a1da1d6d002"],
Cell[22835, 558, 8178, 243, 1017, "Input",ExpressionUUID->"f6733b02-5deb-4034-960b-d3d6e11dce3d"],
Cell[31016, 803, 170, 3, 28, "Input",ExpressionUUID->"65e938b5-6f82-467b-a758-52add5c89e0a"],
Cell[31189, 808, 1193, 31, 105, "Input",ExpressionUUID->"1befad15-650b-4749-895d-848e75a629e4"],
Cell[32385, 841, 1276, 19, 28, "Input",ExpressionUUID->"c15cd7aa-739f-4770-a4a3-ddf4349aefa3"],
Cell[33664, 862, 1954, 49, 181, "Input",ExpressionUUID->"8a559d25-b046-48b4-a7b3-7b6fa729fc06"],
Cell[35621, 913, 302, 5, 28, "Input",ExpressionUUID->"8e158557-56b8-4828-bedd-a60655c115fb"],
Cell[CellGroupData[{
Cell[35948, 922, 1362, 33, 143, "Input",ExpressionUUID->"5b83a2e9-e419-4865-be60-a706805c39a5"],
Cell[37313, 957, 472, 10, 32, "Output",ExpressionUUID->"e0eecd8f-3f34-4d11-b4af-1e072333001a"]
}, Open  ]],
Cell[37800, 970, 172, 4, 28, "Input",ExpressionUUID->"c851d8cf-ef3e-4afb-b873-adfeb64c1e4f"],
Cell[37975, 976, 7941, 148, 352, "Input",ExpressionUUID->"01069217-0729-4118-a1cb-16482e986c53"],
Cell[CellGroupData[{
Cell[45941, 1128, 146, 2, 28, "Input",ExpressionUUID->"8cf9e102-414b-4a32-b78c-2c92ebf93062"],
Cell[46090, 1132, 151, 2, 32, "Output",ExpressionUUID->"0e7f321b-0071-4a07-a720-4d1846e63d4a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46278, 1139, 922, 21, 67, "Input",ExpressionUUID->"b88e8307-2d3a-4fbc-875f-0ba62aa6d03e"],
Cell[47203, 1162, 2527, 41, 72, "Message",ExpressionUUID->"751fb347-f6a3-47f3-911d-2462071ca77b"],
Cell[49733, 1205, 2529, 41, 72, "Message",ExpressionUUID->"70501bea-3d04-485b-8c4d-de9a06520eb2"],
Cell[52265, 1248, 2529, 41, 72, "Message",ExpressionUUID->"49a4972f-06dc-4f28-8a6b-52901d6ff3d6"],
Cell[54797, 1291, 448, 10, 21, "Message",ExpressionUUID->"d5eea080-9c90-4ab2-ab88-4cb79bc4777e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55282, 1306, 2074, 48, 124, "Input",ExpressionUUID->"4cb754ef-f41b-4280-b192-bdf35e7032df"],
Cell[CellGroupData[{
Cell[57381, 1358, 183, 4, 45, "Print",ExpressionUUID->"6c77ff2d-815b-47fb-b122-e5363034a4a7",
 CellTags->"Info2843738497913-3261842"],
Cell[57567, 1364, 2651, 88, 518, "Print",ExpressionUUID->"3452e273-e1e4-4a17-ae6f-c94a727b704b",
 CellTags->"Info2843738497913-3261842"]
}, Open  ]]
}, Open  ]],
Cell[60245, 1456, 274, 4, 28, "Input",ExpressionUUID->"5147f79b-e5f7-4327-8237-053bf9be0966"],
Cell[60522, 1462, 156, 3, 28, InheritFromParent,ExpressionUUID->"05ec5ff6-b25f-4aab-a645-c098653b39a4"],
Cell[60681, 1467, 172, 2, 28, "Input",ExpressionUUID->"342f7630-136c-4166-95d5-c92afbab4a3b"],
Cell[60856, 1471, 172, 2, 28, "Input",ExpressionUUID->"17b365ee-1a13-4856-bb18-a8d48e35b68d"],
Cell[61031, 1475, 154, 3, 28, InheritFromParent,ExpressionUUID->"26a4196f-f650-47fd-9fff-61839d19ce44"],
Cell[61188, 1480, 197, 4, 28, "Input",ExpressionUUID->"7fa41b16-7fe8-415a-8e26-f01b1a0db8cb"],
Cell[61388, 1486, 196, 4, 28, "Input",ExpressionUUID->"2a6a1eea-958f-4430-8e1f-63ab2a2e3021"],
Cell[61587, 1492, 200, 4, 28, "Input",ExpressionUUID->"05808b92-e301-4f41-a097-9f1d70d82bea"],
Cell[61790, 1498, 331, 5, 28, "Input",ExpressionUUID->"36e98c85-6935-4d69-ac84-463776cbc2fa"],
Cell[CellGroupData[{
Cell[62146, 1507, 1433, 35, 162, "Input",ExpressionUUID->"0f7dfab6-7c6e-4d57-b949-1700251eae8a"],
Cell[63582, 1544, 584, 13, 32, "Output",ExpressionUUID->"9c42dee5-7ed4-4b32-aba6-24e68338ad17"]
}, Open  ]],
Cell[64181, 1560, 154, 3, 28, "Input",ExpressionUUID->"d5ff732a-3d09-4bcb-849f-e54387c0cab0"]
}
]
*)

